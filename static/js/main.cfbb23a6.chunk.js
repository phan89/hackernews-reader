(this["webpackJsonphackernews-reader"]=this["webpackJsonphackernews-reader"]||[]).push([[0],{237:function(e,t,n){e.exports=n(450)},450:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(63),i=n.n(o),c=n(8),u=n(9),s=n(10),l=n(11),f=n(12),d=n(13),h=n(2),m=n(3),p="@media only screen and (max-width: 768px)";function g(){var e=Object(m.a)(["\n  position: absolute;\n  width: ","px;\n  height: ","px;\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  margin-left: -","px;\n  margin-top: -","px;\n"]);return g=function(){return e},e}function S(){var e=Object(m.a)(["\n  width: 50%;\n  margin-left: auto;\n  margin-right: auto;\n  height: 100%;\n  overflow: hidden;\n  padding-bottom: 200px;\n  "," {\n    width: 96%;\n  }\n"]);return S=function(){return e},e}var b=h.default.div(S(),p),E=h.default.div(g(),80,80,40,120),O=n(6),v=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},y=[3154e7,2628e6,6048e5,864e5,36e5,6e4,-1/0],_=function(e,t){return function(n,r){return r>=2*n?"".concat(Math.floor(r/n)).concat(e," ago"):t}},T=[_("y","1y ago"),_("M","1M ago"),_("w","1w ago"),_("d","1d ago"),_("h","1h ago"),_("m","1m ago"),function(e){return"just now"}];function k(){var e=Object(m.a)(["\n  display: flex;\n  flex-direction: column;\n  margin-left: auto;\n  width: 100%;\n"]);return k=function(){return e},e}function A(){var e=Object(m.a)(["\n  width: ","px;\n  height: ","px;\n  fill: ",";\n"]);return A=function(){return e},e}function j(){var e=Object(m.a)(["\n  margin-left: auto;\n  margin-right: 0.5em;\n"]);return j=function(){return e},e}function I(){var e=Object(m.a)(["\n  display: flex;\n  cursor: pointer;\n  font-size: ","px;\n  color: ",";\n  align-items: center;\n  text-align: center;\n  margin-top: 0.1em;\n\n  > a {\n    display: flex;\n    color: ",";\n  }\n"]);return I=function(){return e},e}function x(){var e=Object(m.a)(["\n  display: flex;\n  order: 2;\n  width: 100%;\n  max-width: 12em;\n  margin-left: auto;\n"]);return x=function(){return e},e}function C(){var e=Object(m.a)(["\nfloat: left; \nwidth: 400px;\n}\n"]);return C=function(){return e},e}function R(){var e=Object(m.a)(["\n  display: flex;\n"]);return R=function(){return e},e}function w(){var e=Object(m.a)(["\n  color: ",";\n  font-size: 22px;\n  "," {\n    font-size: 18px;\n  }\n  font-weight: 400;\n  display: flex;\n  text-align: center;\n  align-items: center;\n  margin-left: 10px;\n"]);return w=function(){return e},e}function F(){var e=Object(m.a)(["\n  background-color: ",";\n  height: ","px;\n  width: 100%;\n  display: flex;\n  padding: 12px;\n  border-bottom: solid 1px ",";\n  padding-right: 0px;\n"]);return F=function(){return e},e}var D=h.default.header(F(),(function(e){return e.theme.background.secondary}),60,(function(e){return e.theme.border})),M=h.default.h1(w(),(function(e){return e.theme.text.primary}),p),P=h.default.a(R()),B=Object(h.default)(P)(C()),L=h.default.div(x()),U=h.default.div(I(),28,(function(e){return e.theme.text.secondary}),(function(e){return e.theme.text.secondary})),H=Object(h.default)(U)(j()),V=h.default.svg(A(),36,36,(function(e){return e.theme.logo.color})),G=h.default.div(k());function K(){var e=Object(m.a)(["\n  font-size: ","px;\n  margin-right: 4px;\n"]);return K=function(){return e},e}function N(){var e=Object(m.a)(["\n  font-size: ","px;\n"]);return N=function(){return e},e}function Y(){var e=Object(m.a)(["\n  display: flex;\n  padding: 0 8px;\n"]);return Y=function(){return e},e}function z(){var e=Object(m.a)(["\n  display: flex;\n  cursor: pointer;\n  font-size: ","px;\n  color: ",";\n  align-items: center;\n  text-align: center;\n  padding-right: 6px;\n\n  > a {\n    display: flex;\n    color: ",";\n  }\n"]);return z=function(){return e},e}function Q(){var e=Object(m.a)(["\n  margin-left: auto;\n  padding: 0 0 12px 16px;\n"]);return Q=function(){return e},e}function W(){var e=Object(m.a)(["\n  display: flex;\n  flex-direction: column;\n"]);return W=function(){return e},e}function q(){var e=Object(m.a)(["\n  padding-right: 0.5em;\n  flex-direction: column;\n  box-shadow: -1px 3px 10px 1px ",";\n  background-color: ",";\n"]);return q=function(){return e},e}function J(){var e=Object(m.a)(["\n  display: ",";\n  flex-direction: column;\n  background: transparent;\n  padding-top: 20px;\n  z-index: 1000;\n  padding-right: 0.05em;\n"]);return J=function(){return e},e}var X=h.default.div(J(),(function(e){return e.mainMenuVisible?"flex":"none"})),$=h.default.div(q(),(function(e){return e.theme.box_shadow}),(function(e){return e.theme.background.primary})),Z=h.default.ul(W()),ee=h.default.li(Q()),te=h.default.div(z(),14,(function(e){return e.theme.text.secondary}),(function(e){return e.theme.text.secondary})),ne=(h.default.div(Y()),h.default.span(N(),14),h.default.span(K(),14)),re=n(21),ae=n(141),oe={dark:{name:"dark",background:{primary:"#000",secondary:"#0d0a08"},text:{primary:"#bfbebe",secondary:"#848886",disabled:""},hot:{primary:"#ff0000",secondary:"#af0404"},warning:{primary:"#bfbebe",secondary:"#848886"},error:{primary:"#bfbebe",secondary:"#848886"},border:"#272727",box_shadow:"#4B4B4B",logo:{color:"#f57b51"},chatbox:{background:"#331400"},hover:{brightness:"200%",linkColor:""}},light:{name:"light",background:{primary:"#f9f9f9",secondary:"#f3f3f3"},text:{primary:"#000000",secondary:"#0f4c81",disabled:"",primaryHover:"#ff0000"},hot:{primary:"#ff0000",secondary:"#af0404"},warning:{primary:"#bfbebe",secondary:"#848886"},error:{primary:"#bfbebe",secondary:"#848886"},border:"#272727",box_shadow:"#7d7d7d",logo:{color:"#f57b51"},chatbox:{background:"#fff0f0"},hover:{brightness:"95% ",linkColor:"#ff0000 !important"}}},ie="@hsReader/app",ce={SET_THEME:"".concat(ie,"/SET_THEME"),SHOW_MAIN_SETTINGS:"".concat(ie,"/SHOW_MAIN_SETTINGS"),SET_ACTIVE_STORY_SETTINGS:"".concat(ie,"/SET_ACTIVE_STORY_SETTINGS"),SET_PENDING_ACTIONS:"".concat(ie,"/SET_PENDING_ACTIONS")},ue={setTheme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.theme;return localStorage.setItem("preferences.theme",t.name),{type:ce.SET_THEME,payload:e}},setSettingsMenuVisibility:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ce.SHOW_MAIN_SETTINGS,payload:e}},setActiveStorySettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ce.SET_ACTIVE_STORY_SETTINGS,payload:e}},setPendingActions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ce.SET_PENDING_ACTIONS,payload:e}}},se=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).toggleTheme=e.toggleTheme.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"toggleTheme",value:function(e){e.preventDefault();var t=this.props,n=t.theme,r=t.setTheme;n.name===oe.dark.name?r(oe.light):r(oe.dark)}},{key:"render",value:function(){var e=this.props.theme;return a.a.createElement(a.a.Fragment,null,a.a.createElement(ee,{onClick:this.toggleTheme},a.a.createElement(te,null,e.name===oe.dark.name?a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,null,"Use light theme"),a.a.createElement(ae.b,null)):a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,null,"Use dark theme"),a.a.createElement(ae.a,null)))))}}]),t}(r.Component),le=Object(d.b)((function(e){return{theme:e.app.theme}}),(function(e){return{setTheme:function(t){return e(ue.setTheme({theme:t}))}}}))(se),fe=n(4);n(246),n(145);fe.firebase.initializeApp({apiKey:"AIzaSyDfcR5yjdHobjppOkUJohXwwbIwu4sqjLg",authDomain:"hackernews-reader-eb927.firebaseapp.com",databaseURL:"https://hackernews-reader-eb927.firebaseio.com",projectId:"hackernews-reader-eb927",storageBucket:"hackernews-reader-eb927.appspot.com",messagingSenderId:"791336164376",appId:"1:791336164376:web:e18cfe32406ff9f87c776d"}),fe.firebase.firestore();var de=fe.firebase,he={userProfile:"users",useFirestoreForProfile:!0,enableClaims:!0},me=n(7),pe=n(226),ge=n.n(pe),Se=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).URL||"http://localhost:3000",be={"Content-Type":"application/json",Accept:"application/json"},Ee="https://hacker-news.firebaseio.com/v0",Oe=new(function(){function e(t){var n=t.baseURL,r=void 0===n?Se:n,a=t.timeout,o=void 0===a?2e4:a,i=t.headers,u=void 0===i?be:i,s=t.auth;Object(c.a)(this,e);var l=ge.a.create({baseURL:r,timeout:o,headers:u,auth:s});l.interceptors.response.use(this.handleSuccess,this.handleError),this.client=l}return Object(u.a)(e,[{key:"handleSuccess",value:function(e){return e}},{key:"handleError",value:function(e){return Promise.reject(e)}},{key:"get",value:function(e){return this.client.get(e).then((function(e){return e.data}))}},{key:"post",value:function(e,t){return this.client.post(e,t).then((function(e){return e.data}))}},{key:"put",value:function(e,t){return this.client.put(e,t).then((function(e){return e.data}))}},{key:"patch",value:function(e,t){return this.client.patch(e,t).then((function(e){return e.data}))}},{key:"delete",value:function(e){return this.client.delete(e).then((function(e){return e.data}))}}]),e}())({baseURL:Ee}),ve="toFetch",ye="fetching",_e="fetched",Te={fetchTopStoriesIDs:function(){return Oe.get("".concat(Ee,"/topstories").concat(".json?print=pretty"))},fetchStory:function(e){return Oe.get("".concat(Ee,"/item/").concat(e,"/").concat(".json?print=pretty"))},getPageStoryIDs:function(e,t){var n=Te.getPageRange(20,t),r=n.start,a=n.end;return Te.getPageItems(e,r,a)},fetchStoriesByPage:function(e,t){var n=Te.getPageStoryIDs(e,t);if(n){var r=n.map((function(e){return Te.fetchStory(e)}));return Promise.all(r)}return Promise.resolve([])},fetchStoriesIdsAsync:function(e){return e.map((function(e){return Te.fetchStory(e)}))},splitStoryIDsIntoPages:function(e,t){var n=t||20;return e.map((function(t,r){return r%n===0?e.slice(r,r+n):null})).filter((function(e){return e})).map((function(e,t){return{index:t,storyIDs:e,status:ve}}))},getPageRange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{start:e*t,end:e*(t+1)}},getPageItems:function(e,t,n){return e.slice(t,n)},getUserDetailLink:function(e){return"https://news.ycombinator.com/user?id=".concat(e)},getStoryCommentURL:function(e){return"https://news.ycombinator.com/item?id=".concat(e)}},ke=Te,Ae="@hnReader/Story",je={FETCH_TOP_STORY_IDS_REQUEST:"".concat(Ae,"/FETCH_TOP_STORY_IDS_REQUEST"),FETCH_TOP_STORY_IDS_SUCCESS:"".concat(Ae,"/FETCH_TOP_STORY_IDS_SUCCESS"),FETCH_TOP_STORY_IDS_FAILURE:"".concat(Ae,"/FETCH_TOP_STORY_IDS_FAILURE"),FETCH_PAGE_BATCH_STORY_IDS_REQUEST:"".concat(Ae,"/FETCH_PAGE_BATCH_STORY_IDS_REQUEST"),FETCH_PAGE_BATCH_STORY_IDS_SUCCESS:"".concat(Ae,"/FETCH_PAGE_BATCH_STORY_IDS_SUCCESS"),FETCH_PAGE_BATCH_STORY_IDS_FAILURE:"".concat(Ae,"/FETCH_PAGE_BATCH_STORY_IDS_FAILURE"),FETCH_PAGE_BATCHES_REQUEST:"".concat(Ae,"/FETCH_PAGE_BATCHES_REQUEST"),FETCH_PAGE_BATCHES_SUCCESS:"".concat(Ae,"/FETCH_PAGE_BATCHES_SUCCESS"),FETCH_PAGE_BATCHES_FAILURE:"".concat(Ae,"/FETCH_PAGE_BATCHES_FAILURE"),FETCH_PAGE_BATCH_STORIES_REQUEST:"".concat(Ae,"/FETCH_PAGE_BATCH_STORIES_REQUEST"),FETCH_PAGE_BATCH_STORIES_SUCCESS:"".concat(Ae,"/FETCH_PAGE_BATCH_STORIES_SUCCESS"),RELOAD_STORIES:"".concat(Ae,"/RELOAD_STORIES"),ADD_STORY_FAVORITE_SUCCESS:"".concat(Ae,"/ADD_STORY_FAVORITE_SUCCESS"),ADD_STORY_FAVORITE_FAILURE:"".concat(Ae,"/ADD_STORY_FAVORITE_FAILURE"),REMOVE_STORY_FAVORITE_SUCCESS:"".concat(Ae,"/REMOVE_STORY_FAVORITE_SUCCESS"),REMOVE_STORY_FAVORITE_FAILURE:"".concat(Ae,"/REMOVE_STORY_FAVORITE_FAILURE"),FETCH_STORIES_BOOKMARK_REQUEST:"".concat(Ae,"/FETCH_STORIES_BOOKMARK_REQUEST"),FETCH_STORIES_BOOKMARK_SUCCESS:"".concat(Ae,"/FETCH_STORIES_BOOKMARK_SUCCESS"),FETCH_STORIES_BOOKMARK_FAILURE:"".concat(Ae,"/FETCH_STORIES_BOOKMARK_FAILURE"),LOAD_BOOKMARK_STORIES_SUCCESS:"".concat(Ae,"/LOAD_BOOKMARK_STORIES_SUCCESS"),LOAD_BOOKMARK_STORIES_FAILURE:"".concat(Ae,"/LOAD_BOOKMARK_STORIES_FAILURE"),LOAD_BOOKMARK_STORIES_REQUEST:"".concat(Ae,"/LOAD_BOOKMARK_STORIES_REQUEST")},Ie=function(e,t){return{type:e,payload:t}},xe={reloadStories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){t(Ie(je.RELOAD_STORIES,e))}},fetchStoryPages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={payload:e};return function(n){return n(Ie(je.FETCH_TOP_STORY_IDS_REQUEST,e)),ke.fetchTopStoriesIDs().then((function(e){var r=ke.splitStoryIDsIntoPages(e);n(Ie(je.FETCH_TOP_STORY_IDS_SUCCESS,{storyIDs:e,pages:r})),t&&n(xe.fetchBatchesForPage({storyIDs:e,pageIndex:0}))})).catch((function(e){n(Ie(je.FETCH_TOP_STORY_IDS_FAILURE,e))}))}},fetchBatchStoriesFromStoryIDs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.batchStoryIDs,r=e.pageIndex;t(Ie(je.FETCH_PAGE_BATCH_STORIES_REQUEST,Object(me.a)({},e,{pageIndex:r,batchStoryIDs:n})));var a=n.map((function(e){return ke.fetchStory(e)}));return Promise.all(a).then((function(n){var r=Object(me.a)({},e,{batchStories:n});t(Ie(je.FETCH_PAGE_BATCH_STORIES_SUCCESS,r))}))}},fetchBatchesForPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){t(Ie(je.FETCH_PAGE_BATCHES_REQUEST,e));var n=e.storyIDs,r=e.pageIndex,a=ke.getPageStoryIDs(n,r);t(Ie(je.FETCH_PAGE_BATCHES_SUCCESS,Object(me.a)({},e,{pageStoryIDs:a})))}},getFirestoreBookmark:function(e,t){var n=e.firebase.auth.uid;return t.collection("vault").doc(n).collection("favourites")},loadBookmarkStories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n){t(Ie(je.FETCH_TOP_STORY_IDS_REQUEST,e));var r=n(),a=Object.keys(r.story.favStories||{});if(null!==a){var o=ke.splitStoryIDsIntoPages(a);t(Ie(je.FETCH_TOP_STORY_IDS_SUCCESS,{storyIDs:a,pages:o})),t(xe.fetchBatchesForPage({storyIDs:a,pageIndex:0}))}t(Ie(je.LOAD_BOOKMARK_STORIES_REQUEST,e))}},fetchStoriesBookmark:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,r){var a=r.getFirestore;t(Ie(je.FETCH_STORIES_BOOKMARK_REQUEST,e));var o=n(),i=a();xe.getFirestoreBookmark(o,i).get().then((function(n){var r=n.docs.map((function(e){return e.data()}));t(Ie(je.FETCH_STORIES_BOOKMARK_SUCCESS,Object(me.a)({},e,{fetchedFavStories:r})))})).catch((function(n){t(Ie(je.FETCH_STORIES_BOOKMARK_FAILURE,Object(me.a)({},e)))}))}},removeBookmarkStory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,r){var a=r.getFirestore,o=e.story,i=n(),c=a();xe.getFirestoreBookmark(i,c).doc(o.id.toString()).delete().then((function(){t(Ie(je.REMOVE_STORY_FAVORITE_SUCCESS,Object(me.a)({},e)))})).catch((function(n){t(Ie(je.REMOVE_STORY_FAVORITE_FAILURE,Object(me.a)({},e)))}))}},addBookmarkStory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,r){var a=r.getFirestore,o=e.story,i=n(),c=i.firebase.auth.uid,u=a();xe.getFirestoreBookmark(i,u).doc(o.id.toString()).set({id:o.id,userUID:c,added:new Date}).then((function(){t(Ie(je.ADD_STORY_FAVORITE_SUCCESS,Object(me.a)({},e)))})).catch((function(n){t(Ie(je.ADD_STORY_FAVORITE_FAILURE,Object(me.a)({},e)))}))}}},Ce=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).signUserOut=e.signUserOut.bind(Object(O.a)(e)),e.fetchBookmarkStories=e.fetchBookmarkStories.bind(Object(O.a)(e)),e.fetchTopStories=e.fetchTopStories.bind(Object(O.a)(e)),e.toggleSettingsMenu=e.toggleSettingsMenu.bind(Object(O.a)(e)),e.state={savedStoriesLoaded:!1},e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"toggleSettingsMenu",value:function(){var e=this.props.mainMenuVisible;this.props.setSettingsMenuVisibility(!e)}},{key:"signUserOut",value:function(e){de.auth().signOut()}},{key:"fetchBookmarkStories",value:function(e){var t=this.props,n=t.loadBookmarkStories;(0,t.reloadStories)(!0),n(),this.setState({savedStoriesLoaded:!0}),this.toggleSettingsMenu()}},{key:"fetchTopStories",value:function(e){var t=this.props,n=t.fetchStoryPages;(0,t.reloadStories)(!1),n(),this.setState({savedStoriesLoaded:!1}),this.toggleSettingsMenu()}},{key:"render",value:function(){var e=this.props,t=e.firebaseAuth,n=e.isFetching,r=this.state.savedStoriesLoaded;return a.a.createElement(a.a.Fragment,null,a.a.createElement(ee,null,a.a.createElement(te,null,a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,null,t.displayName),a.a.createElement(re.c,null)))),r?a.a.createElement(ee,{disabled:n,onClick:this.fetchTopStories},a.a.createElement(te,null,a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,null,"Top stories"),a.a.createElement(re.f,null)))):a.a.createElement(ee,{disabled:n,onClick:this.fetchBookmarkStories},a.a.createElement(te,null,a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,null,"Saved stories"),a.a.createElement(re.a,null)))),a.a.createElement(le,null),a.a.createElement(ee,null,a.a.createElement(te,{onClick:this.signUserOut},a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,null,"Sign-out"),a.a.createElement(re.e,null)))))}}]),t}(r.Component),Re=Object(d.b)((function(e){var t=e.story;return{firebaseAuth:e.firebase.auth,isFetching:t.isFetching,mainMenuVisible:e.app.mainMenuVisible}}),(function(e){return{loadBookmarkStories:function(){return e(xe.loadBookmarkStories({}))},fetchStoryPages:function(){return e(xe.fetchStoryPages({fetchFirstPage:!0}))},reloadStories:function(t){return e(xe.reloadStories({keepBookmark:t}))},setSettingsMenuVisibility:function(t){return e(ue.setSettingsMenuVisibility({visible:t}))}}}))(Ce),we={UPDATE_AUTH_STATE:"".concat("@hsReader/auth","/UPDATE_AUTH_STATE"),CLOSE_LOGIN_MODAL:"".concat("@hsReader/auth","/CLOSE_LOGIN_MODAL"),OPEN_LOGIN_MODAL:"".concat("@hsReader/auth","/OPEN_LOGIN_MODAL")},Fe=function(e,t){return{type:e,payload:t}},De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){t(Fe(we.UPDATE_AUTH_STATE,e))}},Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){t(Fe(we.CLOSE_LOGIN_MODAL,e))}},Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){t(Fe(we.OPEN_LOGIN_MODAL,e))}},Be=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).openLoginPrompt=e.openLoginPrompt.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"openLoginPrompt",value:function(){this.props.openLoginModal()}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(ee,null,a.a.createElement(te,{onClick:this.openLoginPrompt},a.a.createElement(ne,null,"Login with Google"),a.a.createElement(re.d,null))),a.a.createElement(le,null))}}]),t}(r.Component),Le=Object(d.b)((function(e){return{loginModalOpen:e.auth.loginModalOpen}}),(function(e){return{openLoginModal:function(){return e(Pe({}))}}}))(Be),Ue=n(64),He=n(28),Ve=function(e){return Object(He.isLoaded)(e.firebase.auth)},Ge=Object(Ue.a)(Ve,(function(e){return!Object(He.isEmpty)(e.firebase.auth)}),(function(e,t){return e&&t})),Ke=Object(Ue.a)(Ve,(function(e){return e})),Ne=n(227),Ye=n.n(Ne),ze=n(92);function Qe(){var e=Object(m.a)(["\nwidth: 20rem;\nheight: 100%;\ndisplay: flex;\njustify-content: center;\npadding-top: 20rem;\n"]);return Qe=function(){return e},e}var We=n.n(ze).a.styled(Qe()),qe=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).openLoginPrompt=e.openLoginPrompt.bind(Object(O.a)(e)),e.closeLoginPrompt=e.closeLoginPrompt.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"closeLoginPrompt",value:function(){this.props.closeLoginModal()}},{key:"openLoginPrompt",value:function(){this.props.openLoginModal()}},{key:"render",value:function(){var e=this,t=this.props.loginModalOpen,n={signInFlow:"popup",signInOptions:[de.auth.GoogleAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return e.closeLoginPrompt(),!1}}};return a.a.createElement(We,{isOpen:t,onBackgroundClick:this.closeLoginPrompt,onEscapeKeydown:this.closeLoginPrompt,allowScroll:!0},a.a.createElement(Ye.a,{uiConfig:n,firebaseAuth:de.auth()}))}},{key:"componentDidMount",value:function(){var e=this.props.onAuthChanged;this.unregisterAuthObserver=de.auth().onAuthStateChanged(e)}},{key:"componentWillUnmount",value:function(){this.unregisterAuthObserver()}}]),t}(r.Component),Je=Object(d.b)((function(e){return{theme:e.app.theme,isAuthenticated:Ge(e),isAuthLoaded:Ke(e),firebaseReducer:e.firebase,loginModalOpen:e.auth.loginModalOpen}}),(function(e){return{onAuthChanged:function(t){return e(De({user:t}))},openLoginModal:function(){return e(Pe({}))},closeLoginModal:function(){return e(Me({}))}}}))(qe);function Xe(){var e=Object(m.a)(["\n  text-align: center;\n  span {\n    color: ",";\n    display: inline-block;\n    margin-left: 4px;\n    margin-right: 4px;\n    font-size: 80px;\n    line-height: 0.1;\n    ","\n  }\n"]);return Xe=function(){return e},e}function $e(){var e=Object(m.a)(["\n  /**\n   * Use the blink animation, which is defined above\n   */\n  animation-name: ",";\n  /**mport\n   * The total time of animation\n   */\n  animation-duration: 1s;\n  /**\n   * It will repeat itself forever\n   */\n  animation-iteration-count: infinite;\n  /**\n   * This makes sure that the starting style (opacity: .2)\n   * of the animation is applied before the animation starts.\n   * Otherwise we would see a short flash or would have\n   * to set the default styling of the dots to the same\n   * as the animation. Same applies for the ending styles.\n   */\n  animation-fill-mode: both;\n\n  &:nth-child(2) {\n    animation-delay: 0.2s;\n  }\n\n  &:nth-child(3) {\n    animation-delay: 0.4s;\n  }\n"]);return $e=function(){return e},e}function Ze(){var e=Object(m.a)(["\n  /**\n  * At the start of the animation the dot\n  * has an opacity of .2\n  */\n  0% {\n    opacity: .2;\n  }\n  /**\n  * At 20% the dot is fully visible and\n  * then fades out slowly\n  */\n  20% {\n    opacity: 1;\n  }\n  /**\n  * Until it reaches an opacity of .2 and\n  * the animation can start again\n  */\n  100% {\n    opacity: .2;\n  }\n"]);return Ze=function(){return e},e}var et=Object(h.keyframes)(Ze()),tt=Object(h.css)($e(),et),nt=h.default.div(Xe(),(function(e){return e.theme.text.secondary}),tt),rt=n(229),at=function(){return a.a.createElement("div",null,a.a.createElement(nt,null,a.a.createElement("span",null,"."),a.a.createElement("span",null,"."),a.a.createElement("span",null,".")))},ot=rt.a,it=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).showSettingsMenu=e.showSettingsMenu.bind(Object(O.a)(e)),e.hideSettingsMenu=e.hideSettingsMenu.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"hideSettingsMenu",value:function(){this.props.setSettingsMenuVisibility(!1)}},{key:"showSettingsMenu",value:function(){this.props.setSettingsMenuVisibility(!0)}},{key:"render",value:function(){var e=this.props,t=e.firebaseAuth,n=e.mainMenuVisible,r=t.isLoaded,o=t.isEmpty,i=r&&!o,c=r&&o;return a.a.createElement(a.a.Fragment,null,a.a.createElement(X,{mainMenuVisible:n},a.a.createElement($,{onMouseEnter:this.showSettingsMenu,onMouseLeave:this.hideSettingsMenu},r?a.a.createElement(Z,null,i&&a.a.createElement(Re,null),c&&a.a.createElement(Le,null)):a.a.createElement(at,null))),a.a.createElement(Je,null))}}]),t}(r.Component),ct=Object(d.b)((function(e){return{theme:e.app.theme,mainMenuVisible:e.app.mainMenuVisible,firebaseAuth:e.firebase.auth,firebaseProfile:e.firebase.profile}}),(function(e){return{setTheme:function(t){return e(ue.setTheme({theme:t}))},setSettingsMenuVisibility:function(t){return e(ue.setSettingsMenuVisibility({visible:t}))}}}))(it),ut=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).showSettingsMenu=e.showSettingsMenu.bind(Object(O.a)(e)),e.hideSettingsMenu=e.hideSettingsMenu.bind(Object(O.a)(e)),e.toggleSettingsMenu=e.toggleSettingsMenu.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"hideSettingsMenu",value:function(){this.props.setSettingsMenuVisibility(!1)}},{key:"showSettingsMenu",value:function(){this.props.setSettingsMenuVisibility(!0)}},{key:"toggleSettingsMenu",value:function(e){e.preventDefault();var t=this.props.mainMenuVisible;this.props.setSettingsMenuVisibility(!t)}},{key:"render",value:function(){var e=v();return a.a.createElement(D,null,a.a.createElement(B,{href:"/"},a.a.createElement(V,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M20.496 9.026c-2.183-.93-5.116-1.53-8.25-1.695-.5-.03-.987-.04-1.45-.04 2.318-2.83 4.802-4.73 6.437-4.79.322-.013.595.055.813.196.706.458.905 1.768.545 3.59-.04.25.12.493.36.54.25.05.49-.11.54-.36.45-2.28.12-3.846-.94-4.538-.38-.248-.84-.365-1.35-.346-2.05.077-4.94 2.3-7.59 5.72-1.154.035-2.24.13-3.232.287-.646-2.897-.39-4.977.594-5.477.138-.073.285-.11.457-.124.697-.054 1.66.395 2.71 1.27.194.16.486.14.646-.06a.458.458 0 00-.06-.645C9.466 1.51 8.304 1 7.354 1.07a2.244 2.244 0 00-.803.22c-1.19.607-1.67 2.327-1.37 4.838.07.52.16 1.062.29 1.62C2.19 8.404.1 9.718.01 11.372c-.06 1.17.865 2.284 2.68 3.222a.46.46 0 10.42-.816C1.66 13.032.88 12.19.927 11.42c.05-1.08 1.772-2.19 4.76-2.78.27.994.62 2.032 1.05 3.09-1.018 1.888-1.756 3.747-2.137 5.4-.56 2.465-.26 4.22.86 4.948.36.234.78.35 1.247.35.935 0 2.067-.46 3.347-1.372a.458.458 0 10-.53-.746c-1.544 1.103-2.844 1.472-3.562 1.003-.76-.495-.926-1.943-.46-3.976.32-1.386.907-2.93 1.708-4.52.2.438.41.876.63 1.313 1.425 2.796 3.17 5.227 4.91 6.845 1.386 1.29 2.674 1.963 3.735 1.963.35 0 .68-.075.976-.223 1.145-.585 1.64-2.21 1.398-4.575-.224-2.213-1.06-4.91-2.354-7.6a.46.46 0 00-.83.396c2.69 5.602 2.88 10.19 1.37 10.96-1.59.813-5.424-2.355-8.39-8.18-.34-.655-.637-1.3-.9-1.93.34-.608.7-1.22 1.095-1.83.395-.604.806-1.188 1.224-1.745h.394c.54 0 1.126.01 1.734.048 6.53.343 10.975 2.56 10.884 4.334-.04.765-.924 1.538-2.425 2.12a.464.464 0 00-.26.596.455.455 0 00.593.262c1.905-.74 2.95-1.756 3.01-2.93.07-1.33-1.17-2.61-3.5-3.6v-.01zM8.08 9.45c-.27.415-.52.827-.764 1.244a23.66 23.66 0 01-.723-2.215c.713-.11 1.485-.19 2.31-.24-.28.39-.554.794-.82 1.21v-.01zm3.925 1.175a1.375 1.375 0 100 2.75 1.375 1.375 0 100-2.75z"})),a.a.createElement(M,null,"HKS Reader")),a.a.createElement(L,null,a.a.createElement(G,{onMouseEnter:e?null:this.showSettingsMenu,onMouseLeave:e?null:this.hideSettingsMenu},a.a.createElement(H,null,a.a.createElement(re.g,{onClick:e?this.toggleSettingsMenu:null})),a.a.createElement(ct,null))))}}]),t}(r.Component),st=Object(d.b)((function(e){return{theme:e.app.theme,mainMenuVisible:e.app.mainMenuVisible}}),(function(e){return{setSettingsMenuVisibility:function(t){return e(ue.setSettingsMenuVisibility({visible:t}))}}}))(ut),lt=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"getNextPageToFetch",value:function(e){var t=e.find((function(e){return e.status!==_e}));return t?t.index:-1}},{key:"getFetchedPages",value:function(e){return e.filter((function(e){return e.status===_e}))}},{key:"getPageBatches",value:function(e){var t=e.stories||[];return e.storyIDs.map((function(t,n){return n%5===0?e.storyIDs.slice(n,n+5):null})).filter((function(e){return e})).map((function(n,r){return{index:5*e.index+r,batchStoryIDs:n,batchStories:t.slice(e.index,e.index+5)}}))}}]),e}(),ft=Object(Ue.a)((function(e){var t=e.story.pages;return t?t.map((function(e){return e.index})):0}),(function(e){var t=e.story.pages;return t?t.filter((function(e){return e.status===_e})).map((function(e){return e.index})):0}),(function(e,t){return e.length>t.length})),dt=n(230);function ht(){var e=Object(m.a)(["\n  background-color: ",";\n  border-radius: 4px;\n  margin-left: auto;\n  margin-right: auto;\n  margin-bottom: 20px;\n  display: flex;\n  flex-direction: column;\n\n  margin-before: 1em;\n  margin-after: 1em;\n  margin-start: 0;\n  margin-end: 0;\n  margin: 0;\n"]);return ht=function(){return e},e}var mt=h.default.ul(ht(),(function(e){return e.theme.backgroundSecondary})),pt=n(51);function gt(){var e=Object(m.a)(["\n  color: ",";\n  font-size: 14px;\n  cursor: pointer;\n  margin-right: 5px;\n"]);return gt=function(){return e},e}function St(){var e=Object(m.a)(["\n  margin-left: auto;\n  display: flex;\n  padding: 5px;\n  cursor: pointer;\n  z-index: 100;\n  a {\n    font-size: 14px;\n  }\n  &:hover {\n    filter: brightness(200%);\n  }\n"]);return St=function(){return e},e}function bt(){var e=Object(m.a)(["\n  display: flex;\n  flex-direction: column;\n  position: absolute;\n  z-index: 100;\n  top: -5em;\n  padding: 10px;\n  background-color: ",";\n  filter: brightness(50%);\n  border-radius: 10%;\n  border: 1px solid ",";\n"]);return bt=function(){return e},e}function Et(){var e=Object(m.a)(["\n  position: absolute;\n  top: -1.25em;\n  cursor: pointer;\n  z-index: 99;\n  padding: 7px;\n"]);return Et=function(){return e},e}function Ot(){var e=Object(m.a)(["\n  display: flex;\n  justify-content: flex-end;\n  flex-direction: row;\n  color: ",";\n  padding-right: 1em;\n  position: relative;\n"]);return Ot=function(){return e},e}function vt(){var e=Object(m.a)(["\n  color: ",";\n"]);return vt=function(){return e},e}function yt(){var e=Object(m.a)(["\n  color: ",";\n  &:visited {\n    color: ",";\n  }\n"]);return yt=function(){return e},e}function _t(){var e=Object(m.a)(["\n  font-size: 12px;\n  color: ",";\n"]);return _t=function(){return e},e}function Tt(){var e=Object(m.a)(["\n  color: ",";\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  text-decoration: none;\n  cursor: pointer;\n\n  &:hover {\n    color: ",";\n    h1,\n    h2,\n    h3,\n    span {\n      color: ",";\n    }\n  }\n"]);return Tt=function(){return e},e}function kt(){var e=Object(m.a)(["\n  color: ",";\n  font-size: 12px;\n"]);return kt=function(){return e},e}function At(){var e=Object(m.a)(["\n  color: ",";\n  margin-top: 0;\n  margin-bottom: 6px;\n  font-weight: 400;\n  font-size: 16px;\n  letter-spacing: 0.4px;\n  margin-right: 5px;\n"]);return At=function(){return e},e}function jt(){var e=Object(m.a)(["\n      ","\n    "]);return jt=function(){return e},e}function It(){var e=Object(m.a)(["\n  border-bottom: 1px solid ",";\n  border-top: 1px solid ",";\n\n  flex-flow: row wrap;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  height: 100%;\n\n  ","\n\n  &:hover {\n    filter: brightness(",");\n  }\n"]);return It=function(){return e},e}function xt(){var e=Object(m.a)(["\n  display: flex;\n  flex-direction: column;\n  padding: 14px 0 14px 14px;\n  justify-content: center;\n  flex: 1;\n\n  "," {\n    padding: 1;\n  }\n"]);return xt=function(){return e},e}function Ct(){var e=Object(m.a)(["\n  background-color: ",";\n\n  color: #ff6600;\n  margin-top: 5px;\n\n  display: inline-block;\n  border-radius: 10%;\n  padding: 1px 6px;\n  text-align: center;\n  font-style: normal;\n  font-size: 12px;\n  line-height: 1.45;\n\n  "," {\n    line-height: 1;\n  }\n\n  &:after {\n    margin-top: -0.13rem;\n    margin-left: 0.07rem;\n    border-width: 0.6rem 0.66rem 0 0;\n  }\n"]);return Ct=function(){return e},e}function Rt(){var e=Object(m.a)(["\n  min-width: 80px;\n  height: 100%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: ",";\n  flex-direction: column;\n  background-color: ",";\n  padding: 14px;\n\n  "," {\n    min-width: 60px;\n    padding: 12px;\n  }\n"]);return Rt=function(){return e},e}function wt(){var e=Object(m.a)(["\n  font-size: 12px;\n  color: ",";\n"]);return wt=function(){return e},e}var Ft=h.default.div(wt(),(function(e){return e.theme.hot.primary})),Dt=h.default.div(Rt(),(function(e){return e.theme.hot.primary}),(function(e){return e.theme.background.secondary}),p),Mt=h.default.div(Ct(),(function(e){return e.theme.chatbox.background}),p),Pt=h.default.div(xt(),p),Bt=h.default.li(It(),(function(e){return e.theme.border}),(function(e){return e.theme.border}),(function(e){return e.bogusLoader&&Object(h.css)(jt(),tt)}),(function(e){return e.theme.hover.brightness})),Lt=h.default.h3(At(),(function(e){return e.theme.text.primary})),Ut=h.default.span(kt(),(function(e){return e.theme.text.secondary})),Ht=h.default.a(Tt(),(function(e){return e.theme.text.primary}),(function(e){return e.theme.hover.linkColor}),(function(e){return e.theme.hover.linkColor})),Vt=h.default.div(_t(),(function(e){return e.theme.text.secondary})),Gt=h.default.a(yt(),(function(e){return e.theme.text.secondary}),(function(e){return e.theme.text.secondary})),Kt=h.default.div(vt(),(function(e){return e.theme.text.secondary})),Nt=h.default.div(Ot(),(function(e){return e.theme.text.secondary})),Yt=h.default.div(Et()),zt=h.default.div(bt(),(function(e){return e.theme.background.primary}),(function(e){return e.theme.border})),Qt=h.default.div(St()),Wt=h.default.label(gt(),(function(e){return e.theme.text.secondary})),qt=n(39),Jt=function(e){var t=e.url,n=e.title,r=encodeURIComponent(t),o=encodeURIComponent(n),i="https://getpocket.com/edit?url=".concat(r,"&title=").concat(o,"&tags=hackernews,tech"),c=v();return a.a.createElement(Qt,{onClick:c?null:function(e){e.preventDefault(),function(e,t,n,r){var a=void 0!==window.screenLeft?window.screenLeft:window.screenX,o=void 0!==window.screenTop?window.screenTop:window.screenY,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth,c=window.innerHeight?window.innerHeight:document.documentElement.clientHeight,u=i/window.screen.availWidth,s=(i-n)/2/u+a,l=(c-r)/2/u+o,f=window.open(e,t," scrollbars=yes,\n      width=".concat(n/u,", \n      height=").concat(r/u,", \n      top=").concat(l,", \n      left=").concat(s,"\n      "));window.focus&&f.focus()}(i,"Pocket",550,325)}},a.a.createElement(Ht,{href:i},a.a.createElement(Wt,null,"Pocket story"),a.a.createElement(qt.b,{color:"#ef4056"})))},Xt=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).addStoryBookmarkItem=e.addStoryBookmarkItem.bind(Object(O.a)(e)),e.removeStoryBookmarkItem=e.removeStoryBookmarkItem.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"addStoryBookmarkItem",value:function(e){e.preventDefault();var t=this.props,n=t.story;(0,t.addBookmarkStory)(n)}},{key:"removeStoryBookmarkItem",value:function(e){e.preventDefault();var t=this.props,n=t.story;(0,t.removeBookmarkStory)(n)}},{key:"render",value:function(){var e=this.props.isFavouriteStory;return a.a.createElement(Qt,null,e?a.a.createElement(Ht,{href:"#",onClick:this.removeStoryBookmarkItem},a.a.createElement(Wt,null,"Unsave story"),a.a.createElement(qt.a,{color:"#ef4056"})):a.a.createElement(Ht,{href:"#",onClick:this.addStoryBookmarkItem},a.a.createElement(Wt,null,"Save story"),a.a.createElement(qt.a,{color:"white"})))}}]),t}(r.Component),$t=Object(d.b)((function(e,t){var n=e.story,r=t.story,a=null!==n.favStories;return{isFavouriteStory:r.id in(n.favStories||{}),isFavouriteLoaded:a}}),(function(e){return{addBookmarkStory:function(t){return e(xe.addBookmarkStory({story:t}))},removeBookmarkStory:function(t){return e(xe.removeBookmarkStory({story:t}))}}}))(Xt),Zt=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).toggleStoryActions=e.toggleStoryActions.bind(Object(O.a)(e)),e.showStoryActions=e.showStoryActions.bind(Object(O.a)(e)),e.hideStoryActions=e.hideStoryActions.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"toggleStoryActions",value:function(){var e=this.props,t=e.setActiveStorySettings,n=e.currentActiveStorySetting,r=e.story;t(n&&n===r.id?null:r.id)}},{key:"showStoryActions",value:function(){var e=this.props;(0,e.setActiveStorySettings)(e.story.id)}},{key:"hideStoryActions",value:function(){(0,this.props.setActiveStorySettings)(null)}},{key:"render",value:function(){var e=this.props,t=e.story,n=e.isAuthenticated,r=e.currentActiveStorySetting,o=v(),i=t.url||ke.getStoryCommentURL(t.id),c=r&&r===t.id;return a.a.createElement(Nt,null,a.a.createElement(Yt,{onClick:o?this.toggleStoryActions:null,onMouseEnter:o?null:this.showStoryActions},a.a.createElement(re.b,null)),c&&a.a.createElement(zt,{onMouseLeave:o?null:this.hideStoryActions},a.a.createElement(Qt,{onClick:this.hideStoryActions},a.a.createElement(Wt,null,"Close"),a.a.createElement(qt.c,null)),i&&a.a.createElement(Jt,{url:i,title:t.title}),n&&a.a.createElement($t,{story:t})))}}]),t}(r.Component),en=Object(d.b)((function(e){return{isAuthenticated:Ge(e),currentActiveStorySetting:e.app.currentActiveStorySetting}}),(function(e){return{setActiveStorySettings:function(t){return e(ue.setActiveStorySettings({currentActiveStorySetting:t}))}}}))(Zt),tn=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).hideActiveStorySettings=e.hideActiveStorySettings.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"hideActiveStorySettings",value:function(e){(0,this.props.setActiveStorySettings)(null)}},{key:"render",value:function(){var e,t=this.props,n=t.story,r=t.bogusLoader,o=1e3*n.time,i=function(e){var t=void 0;if(e){var n=e.match(/^https?\:\/\/(?:www\.)?([^\/?#]+)(?:[\/?#]|$)/i);t=n&&n[1]}return t}(n.url),c=ke.getStoryCommentURL(n.id),u=n.url||c;return a.a.createElement(Bt,{bogusLoader:r,onMouseLeave:this.hideActiveStorySettings},a.a.createElement(Ht,(e={href:c},Object(pt.a)(e,"href",c),Object(pt.a)(e,"rel","nofollow noreferrer noopener"),Object(pt.a)(e,"target","_blank"),e),a.a.createElement(Dt,null,a.a.createElement(Ft,null,n.score),a.a.createElement(Mt,null,a.a.createElement(Kt,null," ",n.descendants)))),a.a.createElement(Pt,null,a.a.createElement(Ht,{href:u,rel:"nofollow noreferrer noopener",target:"_blank"},a.a.createElement(Lt,null,n.title)),a.a.createElement(Vt,null,a.a.createElement(Gt,{href:ke.getUserDetailLink(n.by),rel:"nofollow noreferrer noopener",target:"_blank"},n.by," "," | "),a.a.createElement("time",{dateTime:new Date(o).toISOString()},function(e){var t=Date.now()-e,n=y.findIndex((function(e){return t>=e}));return T[n](y[n],t)}(o)),i&&a.a.createElement(Ut,null," | "," ",i)),a.a.createElement(en,{story:n})))}}]),t}(r.Component),nn=Object(d.b)((function(e){return{}}),(function(e){return{setActiveStorySettings:function(t){return e(ue.setActiveStorySettings({currentActiveStorySetting:t}))}}}))(tn),rn=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.batchStories,n=e.bogusLoader;return a.a.createElement(a.a.Fragment,null,t&&t.map((function(e){return a.a.createElement(nn,{key:e.id,story:e,bogusLoader:n})})))}}]),t}(r.Component),an=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.batchStories,n=e.bogusLoader,r=e.batchIndex,o=e.batchStoryIDs,i=e.fetchedStories,c=t;return c&&0!==t.length||(c=[],i&&(c=o.filter((function(e){return e in i})).map((function(e){return i[e]})))),a.a.createElement(rn,{batchStories:c,batchIndex:r,key:r,bogusLoader:n})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.batchStories,n=e.batchStoryIDs,r=e.fetchBatchStoriesFromStoryIDs,a=e.batchIndex,o=e.pageIndex,i=e.fetchedStories;t&&0!==t.length&&i||r(n,a,o)}}]),t}(r.Component),on=Object(d.b)((function(e){var t=e.story.fetchedStories;return{theme:e.app.theme,fetchedStories:t}}),(function(e){return{fetchBatchStoriesFromStoryIDs:function(t,n,r){return e(xe.fetchBatchStoriesFromStoryIDs({batchStoryIDs:t,batchIndex:n,pageIndex:r}))}}}))(an),cn=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.page,n=e.bogusLoader,r=lt.getPageBatches(t),o={};return r&&(o=r.map((function(e){return e.batchStoryIDs.reduce((function(e,t){return e+t}),0)}))),a.a.createElement(mt,{bogusLoader:n},r&&r.map((function(e){var r=e.index+o[e.index%5];return a.a.createElement(on,{batchStoryIDs:e.batchStoryIDs,pageIndex:t.index,batchStories:e.batchStories,batchIndex:e.index,key:r,bogusLoader:n})})))}}]),t}(r.Component),un=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(l.a)(t).call(this))).fetchNextPage=e.fetchNextPage.bind(Object(O.a)(e)),e.refreshData=e.refreshData.bind(Object(O.a)(e)),e}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.pagesFetched,n=e.fetchStoryPages;t||n()}},{key:"componentDidUpdate",value:function(){}},{key:"fetchNextPage",value:function(e){var t=this.props,n=t.nextPageToFetch,r=t.fetchBatchesForPage,a=t.storyIDs;n>=0&&r(a,n)}},{key:"refreshData",value:function(){var e=this.props,t=e.fetchStoryPages;(0,e.reloadStories)(),t()}},{key:"render",value:function(){var e=this.props,t=e.pagedStoriesFetched,n=e.hasMorePages,r=e.nextPageToFetch;return a.a.createElement(dt.a,{dataLength:t.length,next:this.fetchNextPage,hasMore:n,loader:a.a.createElement(at,null),refreshFunction:this.refreshData,pullDownToRefresh:!0,style:{height:"100%",overflow:"visible"},forcedStyle:{overflow:"visible"}},t&&t.map((function(e){return a.a.createElement(cn,{key:e.index,page:e})})),t&&r>1&&n&&a.a.createElement(at,null))}}]),t}(r.Component),sn=Object(d.b)((function(e){var t=e.story,n=t.pages;return{theme:e.app.theme,storyIDs:t.storyIDs,hasMorePages:ft(e),isFetching:t.isFetching,pagedStoriesFetched:lt.getFetchedPages(n),nextPageToFetch:lt.getNextPageToFetch(n),pagesFetched:t.pagesFetched,pages:t.pages}}),(function(e){return{fetchBatchesForPage:function(t,n){return e(xe.fetchBatchesForPage({storyIDs:t,pageIndex:n}))},fetchStoryPages:function(){return e(xe.fetchStoryPages({fetchFirstPage:!0}))},reloadStories:function(){return e(xe.reloadStories())}}}))(un),ln=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.theme,n=e.firebaseReducer,r=e.pendingActions,o=n.auth,i=!o.isLoaded||r;return a.a.createElement(h.ThemeProvider,{theme:t},a.a.createElement(ze.ModalProvider,null,a.a.createElement(b,null,a.a.createElement(st,{firebaseAuth:o}),i&&a.a.createElement(E,null,a.a.createElement(ot,{color:t.text.primary,size:80})),a.a.createElement(sn,null))))}},{key:"componentDidMount",value:function(){this.setBodyBackgroundColor()}},{key:"componentDidUpdate",value:function(){this.setBodyBackgroundColor();var e=this.props,t=e.isAuthenticated,n=e.fetchStoriesBookmark,r=e.fetchingBookmark;t&&null===r&&n()}},{key:"setBodyBackgroundColor",value:function(){document.body.style="background-color: ".concat(this.props.theme.background.primary,";")}}]),t}(r.Component),fn=Object(d.b)((function(e){return{theme:e.app.theme,firebaseReducer:e.firebase,pendingActions:e.app.pendingActions,isAuthenticated:Ge(e),fetchingBookmark:e.story.fetchingBookmark,neverFetchedBookmark:null!==e.story.favStories}}),(function(e){return{fetchStoriesBookmark:function(){return e(xe.fetchStoriesBookmark({}))}}}))(ln);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function dn(){var e=Object(m.a)(["\n    * {\n        box-sizing: border-box;\n    };\n\n    html, body {\n        font-family: Lato,Helvetica-Neue,Helvetica,Arial,sans-serif;\n        width: 100vw;\n        margin: 0;\n        padding: 0;\n      }\n      ul {\n        list-style: none;\n        padding: 0;\n      }\n      a {\n        text-decoration: none;\n        &:visited {\n          color: inherit;\n        }\n      }\n"]);return dn=function(){return e},e}var hn=Object(h.createGlobalStyle)(dn()),mn=n(27),pn=n(231),gn=(n(232),n(65)),Sn=[];Sn.push(pn.a.withExtraArgument({getFirebase:He.getFirebase,getFirestore:gn.getFirestore}));var bn=Object(mn.d)(mn.a.apply(void 0,Sn),Object(gn.reduxFirestore)(de,he)),En=function(){var e=localStorage.getItem("preferences.theme");return{theme:e?oe[e]:oe.dark,mainMenuVisible:!1,currentActiveStorySetting:null,pendingActions:!1}},On=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:En(),t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case ce.SHOW_MAIN_SETTINGS:var a=r.visible;return Object(me.a)({},e,{mainMenuVisible:a});case ce.SET_ACTIVE_STORY_SETTINGS:case ce.SET_PENDING_ACTIONS:case ce.SET_THEME:return Object(me.a)({},e,{},r);default:return e}},vn=n(235),yn=n(236),_n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{storyIDs:[],pages:[],error:"",isFetching:!1,pagesFetched:!1,fetchedStories:{},favStories:null,fetchingBookmark:null},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case je.RELOAD_STORIES:var a=r.keepBookmark,o={storyIDs:[],pages:[],error:"",isFetching:!1,pagesFetched:!1,fetchedStories:{},favStories:null,fetchingBookmark:null};return a?Object(me.a)({},o,{favStories:e.favStories}):o;case je.FETCH_TOP_STORY_IDS_REQUEST:return Object(me.a)({},e,{isFetching:!0});case je.FETCH_PAGE_STORIES_BATCH_REQUEST:case je.FETCH_PAGE_STORIES_REQUEST:var i=r.pageIndex;return e.pages[i].status=ye,Object(me.a)({},e,{isFetching:!0});case je.FETCH_PAGE_BATCH_STORIES_SUCCESS:var c=r.batchStories;return c.map((function(t){return e.fetchedStories[t.id]=t,t.id})),Object(me.a)({},e,{isFetching:!1});case je.FETCH_TOP_STORY_IDS_SUCCESS:var u=r.pages,s="undefined"!==typeof u&&0!==u.length;return Object(me.a)({},e,{},r,{isFetching:!1,pagesFetched:s});case je.FETCH_PAGE_BATCHES_SUCCESS:var l=r.pageStoryIDs,f=r.pageIndex;return l&&e.pages&&e.pages[f]&&(e.pages[f].storyIDs=l,e.pages[f].status=_e),Object(me.a)({},e,{isFetching:!1});case je.FETCH_STORIES_BOOKMARK_REQUEST:return Object(me.a)({},e,{fetchingBookmark:!0});case je.FETCH_STORIES_BOOKMARK_FAILURE:return Object(me.a)({},e,{fetchingBookmark:!1});case je.FETCH_STORIES_BOOKMARK_SUCCESS:var d=r.fetchedFavStories,h=e.favStories||{};return d.map((function(e){return h[e.id]=!0,null})),Object(me.a)({},e,{favStories:h,fetchingBookmark:!1});case je.LOAD_BOOKMARK_STORIES_REQUEST:return Object(me.a)({},e,{isFetching:!1});case je.ADD_STORY_FAVORITE_SUCCESS:var m=r.story;return null===e.favStories&&(e.favStories={}),e.favStories[m.id]=!0,Object(me.a)({},e,{isFetching:!1});case je.REMOVE_STORY_FAVORITE_SUCCESS:var p=r.story,g=e.favStories,S=p.id,b=(g[S],Object(vn.a)(g,[S].map(yn.a)));return Object(me.a)({},e,{favStories:b,isFetching:!1});default:return e}},Tn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginModalOpen:!1},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case we.UPDATE_AUTH_STATE:var a=r.user;return Object(me.a)({},e,{user:a});case we.CLOSE_LOGIN_MODAL:return Object(me.a)({},e,{loginModalOpen:!1});case we.OPEN_LOGIN_MODAL:return Object(me.a)({},e,{loginModalOpen:!0});default:return e}},kn=Object(mn.c)({app:On,story:_n,auth:Tn,firebase:He.firebaseReducer}),An=function(e){return Object(mn.e)(kn,e,bn)};!function(){var e=An();var t={firebase:de,config:he,dispatch:e.dispatch,createFirestoreInstance:gn.createFirestoreInstance};i.a.render(a.a.createElement(d.a,{store:e},a.a.createElement(He.ReactReduxFirebaseProvider,t,a.a.createElement("div",null,a.a.createElement(hn,null),a.a.createElement(fn,null)))),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[237,1,2]]]);
//# sourceMappingURL=main.cfbb23a6.chunk.js.map